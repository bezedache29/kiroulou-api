{
    "openapi": "3.0.0",
    "info": {
        "title": "Kiroulou API Documentation",
        "description": "Documentation de l'API utilisée par l'application mobile KiRoulOu, faite avec Laravel",
        "contact": {
            "email": "bezedache29@gmail.com"
        },
        "license": {
            "name": "Apache 2.0",
            "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
        },
        "version": "0.0.1"
    },
    "servers": [
        {
            "url": "https://localhost/api",
            "description": "Server API KiRoulOu"
        }
    ],
    "paths": {
        "/register": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "Inscription",
                "description": "Inscription d'un utilisateur",
                "operationId": "0903f2e0df1a8857bee538fc055417f0",
                "requestBody": {
                    "$ref": "#/components/requestBodies/PostUser"
                },
                "responses": {
                    "201": {
                        "$ref": "#/components/responses/Created"
                    },
                    "409": {
                        "$ref": "#/components/responses/Conflit"
                    },
                    "422": {
                        "$ref": "#/components/responses/UnprocessableEntity"
                    }
                }
            }
        },
        "/login": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "Connexion",
                "description": "Connexion d'un utilisateur",
                "operationId": "2dd578ff7aba2721293dac66833b27d1",
                "requestBody": {
                    "$ref": "#/components/requestBodies/PostUser"
                },
                "responses": {
                    "200": {
                        "description": "Accès autorisé à la ressource demandée",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "auth_token": {
                                            "description": "Le token d'authentification reçu par Sanctum de Laravel ainsi que le type de token",
                                            "properties": {
                                                "token": {
                                                    "description": "Le token fourni par Sanctum de Laravel",
                                                    "type": "string"
                                                },
                                                "type": {
                                                    "description": "Le type de token reçu",
                                                    "type": "string"
                                                }
                                            },
                                            "type": "object",
                                            "example": {
                                                "token": "2|kqRoYkSd01vGLlDwkYet4CmNdtic46lOYooJZn8A",
                                                "type": "Bearer"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "$ref": "#/components/responses/Forbidden"
                    },
                    "422": {
                        "$ref": "#/components/responses/UnprocessableEntity"
                    }
                }
            }
        },
        "/me": {
            "post": {
                "tags": [
                    "Tests"
                ],
                "summary": "User",
                "description": "Récupère toutes les infos du user connecté",
                "operationId": "af3b8d149797532336b3d65ef346c917",
                "responses": {
                    "200": {
                        "description": "Accès autorisé à la ressource demandée"
                    }
                },
                "security": [
                    {
                        "bearer_token": []
                    }
                ]
            }
        },
        "/clubs": {
            "get": {
                "tags": [
                    "Clubs"
                ],
                "summary": "Tous les clubs",
                "operationId": "866030e46cf2d577d67746695d081d1c",
                "parameters": [
                    {
                        "name": "limit",
                        "in": "query",
                        "description": "Le nombre de clubs à récupérer",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Club"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearer_token": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Clubs"
                ],
                "summary": "Ajout Club",
                "description": "Création d'un club",
                "operationId": "9413538608c46edac6723799dfd1f707",
                "requestBody": {
                    "$ref": "#/components/requestBodies/AddClub"
                },
                "responses": {
                    "201": {
                        "description": "Club créé",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "club created"
                                        },
                                        "user_update": {
                                            "properties": {
                                                "is_club_admin": {
                                                    "description": "Le user devient admin du club qu'il vient de créer",
                                                    "type": "boolean"
                                                },
                                                "club_id": {
                                                    "description": "Le user est membre du club qu'il vient de créer",
                                                    "type": "number"
                                                }
                                            },
                                            "type": "object",
                                            "example": {
                                                "is_club_admin": true,
                                                "club_id": 1
                                            }
                                        },
                                        "club": {
                                            "description": "Détails du club",
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/Club"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Déjà dans un club",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Vous faites déjà partie d'un club !"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearer_token": []
                    }
                ]
            }
        },
        "/clubs/{id}/followOrUnfollow": {
            "post": {
                "tags": [
                    "Clubs"
                ],
                "summary": "Follow club",
                "description": "Follow un club",
                "operationId": "ac4e24e2a9e75208ff9f136ffa5f964c",
                "parameters": [
                    {
                        "$ref": "#/components/parameters/id"
                    }
                ],
                "responses": {
                    "201": {
                        "$ref": "#/components/responses/Created"
                    },
                    "422": {
                        "$ref": "#/components/responses/UnprocessableEntity"
                    }
                },
                "security": [
                    {
                        "bearer_token": []
                    }
                ]
            }
        },
        "/clubs/{id}/requestToJoin": {
            "post": {
                "tags": [
                    "Clubs"
                ],
                "summary": "Request to join club",
                "description": "Demande d'adhésion au club",
                "operationId": "fac8365ba54499cb124b9a6ebc9fb2aa",
                "parameters": [
                    {
                        "$ref": "#/components/parameters/id"
                    }
                ],
                "responses": {
                    "201": {
                        "$ref": "#/components/responses/Created"
                    },
                    "403": {
                        "description": "Demande déjà en cours de traitement",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Votre demande est déjà en traitement pour ce club"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearer_token": []
                    }
                ]
            }
        },
        "/clubs/{id}/acceptRequestToJoin": {
            "post": {
                "tags": [
                    "Clubs"
                ],
                "summary": "Accept user request to join club",
                "description": "Acceptation de la demande d'adhésion d'un user au club",
                "operationId": "faf0e172cad7f6da0002b50390f55392",
                "parameters": [
                    {
                        "$ref": "#/components/parameters/id"
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Accept la demande d'adhésion du user dans le club",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Accept Membership Request"
                                        },
                                        "club": {
                                            "$ref": "#/components/schemas/Club"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "409": {
                        "$ref": "#/components/responses/Conflit"
                    },
                    "422": {
                        "$ref": "#/components/responses/UnprocessableEntity"
                    }
                },
                "security": [
                    {
                        "bearer_token": []
                    }
                ]
            }
        },
        "/clubs/{id}/denyRequestToJoin": {
            "post": {
                "tags": [
                    "Clubs"
                ],
                "summary": "Deny user request to join club",
                "description": "Refus de la demande d'adhésion d'un user au club",
                "operationId": "03115874b39416531e8d194d44e222fd",
                "parameters": [
                    {
                        "$ref": "#/components/parameters/id"
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Refuse la demande d'adhésion du user dans le club",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Deny Membership Request"
                                        },
                                        "club": {
                                            "$ref": "#/components/schemas/Club"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "409": {
                        "$ref": "#/components/responses/Conflit"
                    },
                    "422": {
                        "$ref": "#/components/responses/UnprocessableEntity"
                    }
                },
                "security": [
                    {
                        "bearer_token": []
                    }
                ]
            }
        }
    },
    "components": {
        "schemas": {
            "Address": {
                "description": "Adresse simplifié",
                "properties": {
                    "street_address": {
                        "description": "Rue / lieu-dit",
                        "type": "string",
                        "example": "Ma super adresse"
                    },
                    "lat": {
                        "description": "Lattitude",
                        "type": "string",
                        "example": "48.5740185"
                    },
                    "lng": {
                        "description": "Longitude",
                        "type": "string",
                        "example": "-4.3335965"
                    },
                    "region": {
                        "description": "Region",
                        "type": "string",
                        "example": "Ma super région"
                    },
                    "department": {
                        "description": "Département",
                        "type": "string",
                        "example": "Mon super département"
                    },
                    "department_code": {
                        "description": "Code du département",
                        "type": "string",
                        "example": "29"
                    },
                    "city": {
                        "$ref": "#/components/schemas/City"
                    },
                    "zipcode": {
                        "$ref": "#/components/schemas/Zipcode"
                    }
                },
                "type": "object"
            },
            "City": {
                "description": "Ville",
                "properties": {
                    "name": {
                        "type": "string",
                        "example": "Lesneven"
                    }
                },
                "type": "object"
            },
            "Club": {
                "description": "Club Détails",
                "properties": {
                    "id": {
                        "description": "Id du user",
                        "type": "number",
                        "example": "1"
                    },
                    "name": {
                        "description": "Nom du club",
                        "type": "string",
                        "example": "Côte des légendes VTT"
                    },
                    "shortName": {
                        "description": "Nom raccourci du club",
                        "type": "string",
                        "example": "CDL VTT"
                    },
                    "website": {
                        "description": "Site internet du club",
                        "type": "string",
                        "example": "http://cotedeslegendesvtt.free.fr/",
                        "nullable": true
                    },
                    "avatar": {
                        "description": "Nom de l'avatar (id du club + .png)",
                        "type": "string",
                        "example": "1.png",
                        "nullable": true
                    },
                    "address": {
                        "$ref": "#/components/schemas/Address"
                    },
                    "organization": {
                        "$ref": "#/components/schemas/Organization"
                    },
                    "members": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/UserDetails"
                        }
                    }
                },
                "type": "object"
            },
            "Organization": {
                "description": "Type d'organisation de club",
                "properties": {
                    "name": {
                        "type": "string",
                        "example": "Association"
                    }
                },
                "type": "object"
            },
            "User": {
                "description": "User Simple",
                "properties": {
                    "id": {
                        "description": "Id du user",
                        "type": "number",
                        "example": "1"
                    },
                    "email": {
                        "description": "Email du user",
                        "type": "string",
                        "example": "simon-strueux@gmail.com"
                    },
                    "created_at": {
                        "description": "Date de création du user",
                        "type": "string",
                        "format": "date-time",
                        "nullable": true
                    },
                    "updated_at": {
                        "description": "Date d'édition du user",
                        "type": "string",
                        "format": "date-time",
                        "nullable": true
                    },
                    "deleted_at": {
                        "description": "Date d'e suppression du user",
                        "type": "string",
                        "format": "date-time",
                        "nullable": true
                    }
                },
                "type": "object"
            },
            "UserLoggedIn": {
                "description": "Token du user une fois connecté",
                "properties": {
                    "token": {
                        "description": "Token généré par sanctum, après connexion du user",
                        "type": "string",
                        "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
                    }
                },
                "type": "object"
            },
            "UserDetails": {
                "description": "Détails du user connecté",
                "type": "object",
                "allOf": [
                    {
                        "$ref": "#/components/schemas/User"
                    },
                    {
                        "properties": {
                            "firstname": {
                                "description": "Prénom du user",
                                "type": "string",
                                "example": "Simon",
                                "nullable": true
                            },
                            "lastname": {
                                "description": "Nom du user",
                                "type": "string",
                                "example": "Strueux",
                                "nullable": true
                            },
                            "is_push_notifications": {
                                "description": "Est-ce que le user souhaite recevoir des notifications push",
                                "type": "number",
                                "example": 1
                            },
                            "is_email_notifications": {
                                "description": "Est-ce que le user souhaite recevoir des notifications email",
                                "type": "number",
                                "example": 1
                            },
                            "club_id": {
                                "description": "membre du club ayant l'id du club_id",
                                "type": "number",
                                "example": 1
                            },
                            "is_club_admin": {
                                "description": "Est-ce que le user est admin de son club",
                                "type": "number",
                                "example": 1
                            },
                            "address": {
                                "$ref": "#/components/schemas/Address"
                            }
                        }
                    }
                ]
            },
            "Zipcode": {
                "description": "Code postal",
                "properties": {
                    "code": {
                        "type": "string",
                        "example": "29260"
                    }
                },
                "type": "object"
            }
        },
        "responses": {
            "Conflit": {
                "description": "Conflit de ressource",
                "content": {
                    "application/json": {
                        "schema": {
                            "properties": {
                                "message": {
                                    "type": "string",
                                    "example": "Un compte avec cette adresse email existe déjà"
                                }
                            },
                            "type": "object"
                        }
                    }
                }
            },
            "Created": {
                "description": "Ressource créée",
                "content": {
                    "application/json": {
                        "schema": {
                            "properties": {
                                "message": {
                                    "type": "string",
                                    "example": "user created"
                                }
                            },
                            "type": "object"
                        }
                    }
                }
            },
            "UnprocessableEntity": {
                "description": "Ressource non traitée",
                "content": {
                    "application/json": {
                        "schema": {
                            "properties": {
                                "email": {
                                    "type": "array",
                                    "items": {},
                                    "example": [
                                        "L'adresse email est obligatoire"
                                    ]
                                }
                            },
                            "type": "object"
                        }
                    }
                }
            },
            "Forbidden": {
                "description": "Accès refusé à la ressource demandée",
                "content": {
                    "application/json": {
                        "schema": {
                            "properties": {
                                "message": {
                                    "type": "string",
                                    "example": "email et/ou mot de passe incorrect(s)"
                                }
                            },
                            "type": "object"
                        }
                    }
                }
            }
        },
        "parameters": {
            "id": {
                "name": "id",
                "in": "path",
                "description": "ID de la ressource",
                "required": true,
                "schema": {
                    "type": "integer"
                }
            }
        },
        "requestBodies": {
            "AddAddress": {
                "required": true,
                "content": {
                    "application/json": {
                        "schema": {
                            "required": [
                                "street_address, lat, lng, region, department, department_code"
                            ],
                            "properties": {
                                "street_address": {
                                    "type": "string",
                                    "example": "Ma super rue"
                                },
                                "lat": {
                                    "description": "Lattitude GPS",
                                    "type": "string",
                                    "example": "48.5740185"
                                },
                                "lng": {
                                    "description": "Longitude GPS",
                                    "type": "string",
                                    "example": "-4.3335965"
                                },
                                "region": {
                                    "type": "string",
                                    "example": "Bretagne"
                                },
                                "department": {
                                    "type": "string",
                                    "example": "Finistère"
                                },
                                "department_code": {
                                    "type": "string",
                                    "example": "29"
                                }
                            },
                            "type": "object"
                        }
                    }
                }
            },
            "AddClub": {
                "required": true,
                "content": {
                    "application/json": {
                        "schema": {
                            "required": [
                                "name, street_address, city, zipcode, lat, lng, region, department, department_code, organization"
                            ],
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "example": "Mon super club"
                                },
                                "shortName": {
                                    "description": "Diminutif du club",
                                    "type": "string",
                                    "example": "MSC"
                                },
                                "website": {
                                    "type": "string",
                                    "example": "https://mon-super-club.com"
                                },
                                "avatar": {
                                    "description": "Renommage de l'avatar avec id du club",
                                    "type": "string",
                                    "example": "1.png"
                                },
                                "organization": {
                                    "description": "organization_id du type de club",
                                    "type": "number",
                                    "example": "3"
                                },
                                "street_address": {
                                    "type": "string",
                                    "example": "Ma super rue"
                                },
                                "city": {
                                    "type": "string",
                                    "example": "Nantes"
                                },
                                "zipcode": {
                                    "type": "string",
                                    "example": "44000"
                                },
                                "lat": {
                                    "description": "Lattitude GPS",
                                    "type": "string",
                                    "example": "48.5740185"
                                },
                                "lng": {
                                    "description": "Longitude GPS",
                                    "type": "string",
                                    "example": "-4.3335965"
                                },
                                "region": {
                                    "type": "string",
                                    "example": "Bretagne"
                                },
                                "department": {
                                    "type": "string",
                                    "example": "Finistère"
                                },
                                "department_code": {
                                    "type": "string",
                                    "example": "29"
                                }
                            },
                            "type": "object"
                        }
                    }
                }
            },
            "FollowClub": {
                "required": true,
                "content": {
                    "application/json": {
                        "schema": {
                            "required": [
                                "user_id, club_id"
                            ],
                            "properties": {
                                "user_id": {
                                    "type": "number",
                                    "example": "1005"
                                },
                                "club_id": {
                                    "type": "number",
                                    "example": "2"
                                }
                            },
                            "type": "object"
                        }
                    }
                }
            },
            "PostUser": {
                "required": true,
                "content": {
                    "application/json": {
                        "schema": {
                            "required": [
                                "email, password"
                            ],
                            "properties": {
                                "email": {
                                    "type": "string",
                                    "example": "simon-strueux@gmail.com"
                                },
                                "password": {
                                    "type": "string",
                                    "example": "password12345"
                                }
                            },
                            "type": "object"
                        }
                    }
                }
            }
        },
        "securitySchemes": {
            "bearer_token": {
                "type": "http",
                "description": "S'authentifier avec email & password pour récupérer un token d'authentification",
                "name": "Authorization",
                "in": "header",
                "bearerFormat": "JWT",
                "scheme": "bearer"
            }
        }
    },
    "tags": [
        {
            "name": "Auth",
            "description": "Opérations d'authentification"
        },
        {
            "name": "Clubs",
            "description": "Opérations en relation avec les clubs"
        }
    ]
}